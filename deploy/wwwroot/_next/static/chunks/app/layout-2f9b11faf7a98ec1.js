(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3185],{73456:function(e,t,r){Promise.resolve().then(r.t.bind(r,39974,23)),Promise.resolve().then(r.bind(r,69064)),Promise.resolve().then(r.t.bind(r,2778,23)),Promise.resolve().then(r.bind(r,48847))},48847:function(e,t,r){"use strict";r.d(t,{Providers:function(){return l}});var o=r(57437),s=r(2265),n=r(71245),a=r(12025),c=r(13183);function l(e){let{children:t}=e,[r,l]=(0,s.useState)(!1);return((0,s.useEffect)(()=>{l(!0)},[]),r)?(0,o.jsx)(a.f,{children:(0,o.jsx)(c.z,{children:(0,o.jsx)(n.H,{children:t})})}):null}},71245:function(e,t,r){"use strict";r.d(t,{H:function(){return i},a:function(){return u}});var o=r(57437),s=r(2265),n=r(99376),a=r(71837),c=r(69064);let l=(0,s.createContext)(void 0);function i(e){let{children:t}=e,[r,i]=(0,s.useState)(null),[u,d]=(0,s.useState)(!0),m=(0,n.useRouter)();(0,s.useEffect)(()=>{h()},[]);let h=async()=>{try{let e=localStorage.getItem("token");if(!e){d(!1);return}let t=localStorage.getItem("demo_user");if(e.startsWith("demo-token-")&&t){let e=JSON.parse(t);i(e),d(!1);return}let r=await a.ZP.get("/auth/me");i(r.data)}catch(t){let e=localStorage.getItem("demo_user");if(e)try{let t=JSON.parse(e);i(t),d(!1);return}catch(e){}localStorage.removeItem("token"),localStorage.removeItem("demo_user")}finally{d(!1)}},f=async(e,t)=>{try{let{token:r,user:o}=(await a.ZP.post("/auth/login",e)).data;if(localStorage.setItem("token",r),i(o),o.requiereCambioPassword){m.push("/cambiar-password");return}if(t&&y(t,o.rol)){m.push(t),c.ZP.success("Bienvenido, ".concat(o.nombre));return}switch(o.rol){case"Admin":m.push("/admin/dashboard");break;case"Empleado":m.push("/empleado/dashboard");break;case"Cliente":m.push("/cliente/tickets")}c.ZP.success("Bienvenido, ".concat(o.nombre))}catch(t){var r,o;let e=(null===(o=t.response)||void 0===o?void 0:null===(r=o.data)||void 0===r?void 0:r.message)||"Error al iniciar sesion";throw c.ZP.error(e),t}},y=(e,t)=>"Admin"===t||("Empleado"===t?e.startsWith("/empleado/")||e.startsWith("/admin/tickets"):"Cliente"===t&&e.startsWith("/cliente/")),p=async()=>{try{let e=localStorage.getItem("token");(null==e?void 0:e.startsWith("demo-token-"))||await a.ZP.post("/auth/logout")}catch(e){}finally{localStorage.removeItem("token"),localStorage.removeItem("demo_user"),i(null),m.push("/login"),c.ZP.success("Sesion cerrada")}};return(0,o.jsx)(l.Provider,{value:{user:r,isLoading:u,login:f,logout:p,updateUser:e=>{i(e)}},children:t})}function u(){let e=(0,s.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},13183:function(e,t,r){"use strict";r.d(t,{K:function(){return d},z:function(){return u}});var o=r(57437),s=r(2265),n=r(71837);let a={colorPrimario:"#2563eb",colorSecundario:"#64748b",nombreSistema:"MDAyuda",logoUrl:""},c=(0,s.createContext)(void 0);function l(e){let t=parseInt(e.slice(1,3),16)/255,r=parseInt(e.slice(3,5),16)/255,o=parseInt(e.slice(5,7),16)/255,s=Math.max(t,r,o),n=Math.min(t,r,o),a=0,c=0,l=(s+n)/2;if(s!==n){let e=s-n;switch(c=l>.5?e/(2-s-n):e/(s+n),s){case t:a=((r-o)/e+(r<o?6:0))/6;break;case r:a=((o-t)/e+2)/6;break;case o:a=((t-r)/e+4)/6}}return{h:360*a,s:100*c,l:100*l}}function i(e){let t=document.documentElement,r=l(e.colorPrimario);t.style.setProperty("--color-primary",e.colorPrimario),t.style.setProperty("--color-primary-50","hsl(".concat(r.h,", ").concat(r.s,"%, 95%)")),t.style.setProperty("--color-primary-100","hsl(".concat(r.h,", ").concat(r.s,"%, 90%)")),t.style.setProperty("--color-primary-200","hsl(".concat(r.h,", ").concat(r.s,"%, 80%)")),t.style.setProperty("--color-primary-300","hsl(".concat(r.h,", ").concat(r.s,"%, 70%)")),t.style.setProperty("--color-primary-400","hsl(".concat(r.h,", ").concat(r.s,"%, 60%)")),t.style.setProperty("--color-primary-500",e.colorPrimario),t.style.setProperty("--color-primary-600","hsl(".concat(r.h,", ").concat(r.s,"%, 40%)")),t.style.setProperty("--color-primary-700","hsl(".concat(r.h,", ").concat(r.s,"%, 30%)")),t.style.setProperty("--color-primary-800","hsl(".concat(r.h,", ").concat(r.s,"%, 20%)")),t.style.setProperty("--color-primary-900","hsl(".concat(r.h,", ").concat(r.s,"%, 10%)"));let o=l(e.colorSecundario);t.style.setProperty("--color-secondary",e.colorSecundario),t.style.setProperty("--color-secondary-50","hsl(".concat(o.h,", ").concat(o.s,"%, 95%)")),t.style.setProperty("--color-secondary-100","hsl(".concat(o.h,", ").concat(o.s,"%, 90%)")),t.style.setProperty("--color-secondary-500",e.colorSecundario),t.style.setProperty("--color-secondary-600","hsl(".concat(o.h,", ").concat(o.s,"%, 40%)")),t.style.setProperty("--color-secondary-700","hsl(".concat(o.h,", ").concat(o.s,"%, 30%)"))}function u(e){let{children:t}=e,[r,l]=(0,s.useState)(a),[u,d]=(0,s.useState)(!0),[m,h]=(0,s.useState)(!1),f=async()=>{try{let e=await n.ZP.get("/configuracion/tema");l(e.data),m&&i(e.data)}catch(e){console.error("Error fetching system theme:",e),m&&i(a)}finally{d(!1)}};(0,s.useEffect)(()=>{h(!0),f()},[]),(0,s.useEffect)(()=>{m&&r&&i(r)},[m,r]);let y=async()=>{await f()};return m?(0,o.jsx)(c.Provider,{value:{systemTheme:r,loading:u,refreshTheme:y},children:t}):null}function d(){let e=(0,s.useContext)(c);if(void 0===e)throw Error("useSystemTheme must be used within a SystemThemeProvider");return e}},12025:function(e,t,r){"use strict";r.d(t,{F:function(){return c},f:function(){return a}});var o=r(57437),s=r(2265);let n=(0,s.createContext)(void 0);function a(e){let{children:t}=e,[r,a]=(0,s.useState)("light"),[c,l]=(0,s.useState)(!1);return((0,s.useEffect)(()=>{l(!0);let e=localStorage.getItem("theme");e?a(e):window.matchMedia("(prefers-color-scheme: dark)").matches&&a("dark")},[]),(0,s.useEffect)(()=>{if(!c)return;let e=document.documentElement;"dark"===r?e.classList.add("dark"):e.classList.remove("dark"),localStorage.setItem("theme",r)},[r,c]),c)?(0,o.jsx)(n.Provider,{value:{theme:r,toggleTheme:()=>{a(e=>"light"===e?"dark":"light")},setTheme:e=>{a(e)}},children:t}):null}function c(){let e=(0,s.useContext)(n);if(void 0===e)throw Error("useTheme must be used within a ThemeProvider");return e}},71837:function(e,t,r){"use strict";var o=r(83464);let s=(()=>{{let e=window.location.hostname;return"localhost"===e||"127.0.0.1"===e?"http://localhost:5000/api":"/api"}})(),n=o.Z.create({baseURL:s,headers:{"Content-Type":"application/json"},timeout:3e4});n.interceptors.request.use(e=>{{let t=localStorage.getItem("token");t&&(e.headers.Authorization="Bearer ".concat(t))}return e},e=>Promise.reject(e)),n.interceptors.response.use(e=>e,e=>{if(e.response){let{status:t,data:r}=e.response;if(401===t){localStorage.removeItem("token");let e=window.location.pathname;e.includes("/login")||e.includes("/solicitar-registro")||(window.location.href="/login")}if(403===t&&console.error("Access forbidden:",null==r?void 0:r.message),400===t&&(null==r?void 0:r.errors)){let t=Object.values(r.errors).flat().join(", ");e.message=t||r.message||"Error de validacion"}}else e.request&&(e.message="Error de conexion. Verifica tu conexion a internet.");return Promise.reject(e)}),t.ZP=n},2778:function(){},39974:function(e){e.exports={style:{fontFamily:"'__Inter_f367f3', '__Inter_Fallback_f367f3'",fontStyle:"normal"},className:"__className_f367f3"}}},function(e){e.O(0,[635,7859,3464,2971,2117,1744],function(){return e(e.s=73456)}),_N_E=e.O()}]);