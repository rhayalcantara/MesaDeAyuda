(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2626],{80446:function(e,t,r){Promise.resolve().then(r.bind(r,38991))},38991:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return u}});var a=r(57437),s=r(2265),o=r(27648),i=r(99376),n=r(71245),l=r(12025),c=r(70001),d=r(99158);function u(){let[e,t]=(0,s.useState)(""),[r,u]=(0,s.useState)(""),[m,h]=(0,s.useState)(!1),[v,p]=(0,s.useState)(""),{login:g}=(0,n.a)(),{theme:f,toggleTheme:x}=(0,l.F)(),w=(0,i.useSearchParams)().get("redirect"),b=async t=>{if(t.preventDefault(),p(""),h(!0),"demo-401@test.com"===e){await new Promise(e=>setTimeout(e,1e3)),p("Credenciales incorrectas. Por favor, verifique su correo y contrasena."),h(!1);return}if("demo-403@test.com"===e){await new Promise(e=>setTimeout(e,1e3)),p("Su cuenta ha sido desactivada. Contacte al administrador."),h(!1);return}if("demo-500@test.com"===e){await new Promise(e=>setTimeout(e,1e3)),p("Error en el servidor. Por favor, intente nuevamente mas tarde."),h(!1);return}try{await g({email:e,password:r},w||void 0)}catch(e){var a,s,o,i,n;"ERR_NETWORK"===e.code||"Network Error"===e.message?p("No se pudo conectar al servidor. Por favor, verifique su conexion a internet e intente nuevamente."):(null===(a=e.response)||void 0===a?void 0:a.status)===401?p("Credenciales incorrectas. Por favor, verifique su correo y contrasena."):(null===(s=e.response)||void 0===s?void 0:s.status)===403?p("Su cuenta ha sido desactivada. Contacte al administrador."):(null===(o=e.response)||void 0===o?void 0:o.status)>=500?p("Error en el servidor. Por favor, intente nuevamente mas tarde."):p((null===(n=e.response)||void 0===n?void 0:null===(i=n.data)||void 0===i?void 0:i.message)||"Error al iniciar sesion. Por favor, intente nuevamente.")}finally{h(!1)}};return(0,a.jsxs)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 py-12 px-4 sm:px-6 lg:px-8",children:[(0,a.jsx)("div",{className:"absolute top-4 right-4",children:(0,a.jsx)("button",{onClick:x,className:"p-2 rounded-lg bg-white dark:bg-gray-800 shadow-md hover:shadow-lg transition-shadow","aria-label":"Toggle theme",children:"light"===f?(0,a.jsx)(c.Z,{className:"h-6 w-6 text-gray-600 dark:text-gray-300","aria-hidden":"true"}):(0,a.jsx)(d.Z,{className:"h-6 w-6 text-gray-600 dark:text-gray-300","aria-hidden":"true"})})}),(0,a.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-center text-4xl font-bold text-primary-600 dark:text-primary-400",children:"MDAyuda"}),(0,a.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900 dark:text-white",children:"Iniciar Sesion"}),(0,a.jsx)("p",{className:"mt-2 text-center text-sm text-gray-600 dark:text-gray-400",children:"Ingresa tus credenciales para acceder al sistema"})]}),(0,a.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:b,children:[(0,a.jsxs)("div",{className:"card p-6 space-y-4",children:[v&&(0,a.jsx)("div",{id:"login-error",role:"alert","aria-live":"assertive",className:"bg-red-50 dark:bg-red-900/50 border border-red-200 dark:border-red-800 text-red-700 dark:text-red-300 px-4 py-3 rounded-lg text-sm",children:v}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"email",className:"label",children:"Correo electronico"}),(0,a.jsx)("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:e,onChange:e=>t(e.target.value),className:"input ".concat(v?"border-red-300 dark:border-red-700":""),placeholder:"correo@ejemplo.com","aria-invalid":v?"true":void 0,"aria-describedby":v?"login-error":void 0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"password",className:"label",children:"Contrasena"}),(0,a.jsx)("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:r,onChange:e=>u(e.target.value),className:"input ".concat(v?"border-red-300 dark:border-red-700":""),placeholder:"••••••••","aria-invalid":v?"true":void 0,"aria-describedby":v?"login-error":void 0})]}),(0,a.jsx)("button",{type:"submit",disabled:m,className:"btn-primary w-full py-3",children:m?(0,a.jsxs)("span",{className:"flex items-center justify-center",children:[(0,a.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Iniciando sesion..."]}):"Iniciar Sesion"})]}),(0,a.jsx)("div",{className:"text-center",children:(0,a.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["\xbfNo tienes una cuenta?"," ",(0,a.jsx)(o.default,{href:"/solicitar-registro",className:"font-medium text-primary-600 hover:text-primary-500 dark:text-primary-400",children:"Solicitar registro"})]})})]})]})]})}},71245:function(e,t,r){"use strict";r.d(t,{H:function(){return c},a:function(){return d}});var a=r(57437),s=r(2265),o=r(99376),i=r(71837),n=r(69064);let l=(0,s.createContext)(void 0);function c(e){let{children:t}=e,[r,c]=(0,s.useState)(null),[d,u]=(0,s.useState)(!0),m=(0,o.useRouter)();(0,s.useEffect)(()=>{h()},[]);let h=async()=>{try{let e=localStorage.getItem("token");if(!e){u(!1);return}let t=localStorage.getItem("demo_user");if(e.startsWith("demo-token-")&&t){let e=JSON.parse(t);c(e),u(!1);return}let r=await i.ZP.get("/auth/me");c(r.data)}catch(t){let e=localStorage.getItem("demo_user");if(e)try{let t=JSON.parse(e);c(t),u(!1);return}catch(e){}localStorage.removeItem("token"),localStorage.removeItem("demo_user")}finally{u(!1)}},v=async(e,t)=>{try{let{token:r,user:a}=(await i.ZP.post("/auth/login",e)).data;if(localStorage.setItem("token",r),c(a),a.requiereCambioPassword){m.push("/cambiar-password");return}if(t&&p(t,a.rol)){m.push(t),n.ZP.success("Bienvenido, ".concat(a.nombre));return}switch(a.rol){case"Admin":m.push("/admin/dashboard");break;case"Empleado":m.push("/empleado/dashboard");break;case"Cliente":m.push("/cliente/tickets")}n.ZP.success("Bienvenido, ".concat(a.nombre))}catch(t){var r,a;let e=(null===(a=t.response)||void 0===a?void 0:null===(r=a.data)||void 0===r?void 0:r.message)||"Error al iniciar sesion";throw n.ZP.error(e),t}},p=(e,t)=>"Admin"===t||("Empleado"===t?e.startsWith("/empleado/")||e.startsWith("/admin/tickets"):"Cliente"===t&&e.startsWith("/cliente/")),g=async()=>{try{let e=localStorage.getItem("token");(null==e?void 0:e.startsWith("demo-token-"))||await i.ZP.post("/auth/logout")}catch(e){}finally{localStorage.removeItem("token"),localStorage.removeItem("demo_user"),c(null),m.push("/login"),n.ZP.success("Sesion cerrada")}};return(0,a.jsx)(l.Provider,{value:{user:r,isLoading:d,login:v,logout:g,updateUser:e=>{c(e)}},children:t})}function d(){let e=(0,s.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},12025:function(e,t,r){"use strict";r.d(t,{F:function(){return n},f:function(){return i}});var a=r(57437),s=r(2265);let o=(0,s.createContext)(void 0);function i(e){let{children:t}=e,[r,i]=(0,s.useState)("light"),[n,l]=(0,s.useState)(!1);return((0,s.useEffect)(()=>{l(!0);let e=localStorage.getItem("theme");e?i(e):window.matchMedia("(prefers-color-scheme: dark)").matches&&i("dark")},[]),(0,s.useEffect)(()=>{if(!n)return;let e=document.documentElement;"dark"===r?e.classList.add("dark"):e.classList.remove("dark"),localStorage.setItem("theme",r)},[r,n]),n)?(0,a.jsx)(o.Provider,{value:{theme:r,toggleTheme:()=>{i(e=>"light"===e?"dark":"light")},setTheme:e=>{i(e)}},children:t}):null}function n(){let e=(0,s.useContext)(o);if(void 0===e)throw Error("useTheme must be used within a ThemeProvider");return e}},71837:function(e,t,r){"use strict";var a=r(83464);let s=(()=>{{let e=window.location.hostname;return"localhost"===e||"127.0.0.1"===e?"http://localhost:5000/api":"/api"}})(),o=a.Z.create({baseURL:s,headers:{"Content-Type":"application/json"},timeout:3e4});o.interceptors.request.use(e=>{{let t=localStorage.getItem("token");t&&(e.headers.Authorization="Bearer ".concat(t))}return e},e=>Promise.reject(e)),o.interceptors.response.use(e=>e,e=>{if(e.response){let{status:t,data:r}=e.response;if(401===t){localStorage.removeItem("token");let e=window.location.pathname;e.includes("/login")||e.includes("/solicitar-registro")||(window.location.href="/login")}if(403===t&&console.error("Access forbidden:",null==r?void 0:r.message),400===t&&(null==r?void 0:r.errors)){let t=Object.values(r.errors).flat().join(", ");e.message=t||r.message||"Error de validacion"}}else e.request&&(e.message="Error de conexion. Verifica tu conexion a internet.");return Promise.reject(e)}),t.ZP=o},70001:function(e,t,r){"use strict";var a=r(2265);let s=a.forwardRef(function(e,t){let{title:r,titleId:s,...o}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":s},o),r?a.createElement("title",{id:s},r):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.752 15.002A9.72 9.72 0 0 1 18 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 0 0 3 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 0 0 9.002-5.998Z"}))});t.Z=s},99158:function(e,t,r){"use strict";var a=r(2265);let s=a.forwardRef(function(e,t){let{title:r,titleId:s,...o}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":s},o),r?a.createElement("title",{id:s},r):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"}))});t.Z=s}},function(e){e.O(0,[7648,7859,3464,2971,2117,1744],function(){return e(e.s=80446)}),_N_E=e.O()}]);