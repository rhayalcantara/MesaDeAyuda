(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6349],{44022:function(e,a,r){Promise.resolve().then(r.bind(r,43996))},43996:function(e,a,r){"use strict";r.r(a),r.d(a,{default:function(){return c}});var t=r(57437),i=r(2265),s=r(99376),l=r(81076),n=r(71245),d=r(71837);function c(){let e=(0,s.useRouter)(),{user:a}=(0,n.a)(),[r,c]=(0,i.useState)(!1),[o,u]=(0,i.useState)(""),[x,m]=(0,i.useState)(""),[p,h]=(0,i.useState)([]),[b,g]=(0,i.useState)(!0),[j,v]=(0,i.useState)(""),[y,N]=(0,i.useState)(""),[f,k]=(0,i.useState)(""),[C,S]=(0,i.useState)("Media");(0,i.useEffect)(()=>{(async()=>{try{let e=await d.ZP.get("/categorias");h(e.data)}catch(e){console.error("Error loading categories:",e),h([{id:1,nombre:"Sistema de Ventas"},{id:2,nombre:"Sistema de Inventario"},{id:3,nombre:"Portal Web"},{id:4,nombre:"Aplicacion Movil"},{id:5,nombre:"Otro"}])}finally{g(!1)}})()},[]);let w=async a=>{if(a.preventDefault(),u(""),m(""),c(!0),!j.trim()){u("El titulo es requerido"),c(!1);return}if(!y.trim()){u("La descripcion es requerida"),c(!1);return}if(!f){u("Debe seleccionar una categoria"),c(!1);return}try{await d.ZP.post("/tickets",{titulo:j.trim(),descripcion:y.trim(),categoriaId:parseInt(f),prioridad:C}),m("Ticket creado exitosamente"),setTimeout(()=>{e.push("/cliente/tickets")},1500)}catch(e){var r,t;u((null===(t=e.response)||void 0===t?void 0:null===(r=t.data)||void 0===r?void 0:r.message)||"Error al crear el ticket")}finally{c(!1)}};return(0,t.jsx)(l.Z,{requiredRoles:["Cliente"],children:(0,t.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Crear Nuevo Ticket"}),(0,t.jsx)("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:"Complete el formulario para reportar un problema o solicitud"})]}),(0,t.jsxs)("form",{onSubmit:w,className:"card p-6 space-y-6",children:[o&&(0,t.jsx)("div",{className:"bg-red-50 dark:bg-red-900/50 border border-red-200 dark:border-red-800 text-red-700 dark:text-red-300 px-4 py-3 rounded-lg text-sm",role:"alert","aria-live":"assertive",children:o}),x&&(0,t.jsx)("div",{className:"bg-green-50 dark:bg-green-900/50 border border-green-200 dark:border-green-800 text-green-700 dark:text-green-300 px-4 py-3 rounded-lg text-sm",role:"status","aria-live":"polite",children:x}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"titulo",className:"label",children:["Titulo del ticket ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("input",{id:"titulo",name:"titulo",type:"text",required:!0,value:j,onChange:e=>v(e.target.value),className:"input",placeholder:"Describe brevemente el problema",maxLength:200,"aria-describedby":"titulo-hint"}),(0,t.jsx)("p",{id:"titulo-hint",className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Maximo 200 caracteres"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"categoria",className:"label",children:["Categoria (Sistema) ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsxs)("select",{id:"categoria",name:"categoria",required:!0,value:f,onChange:e=>k(e.target.value),className:"input",disabled:b,"aria-describedby":"categoria-hint",children:[(0,t.jsx)("option",{value:"",children:"Seleccione una categoria"}),p.map(e=>(0,t.jsx)("option",{value:e.id,children:e.nombre},e.id))]}),(0,t.jsx)("p",{id:"categoria-hint",className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Seleccione el sistema relacionado con el problema"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"prioridad",className:"label",children:["Prioridad ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsxs)("select",{id:"prioridad",name:"prioridad",required:!0,value:C,onChange:e=>S(e.target.value),className:"input","aria-describedby":"prioridad-hint",children:[(0,t.jsx)("option",{value:"Baja",children:"Baja - Puede esperar"}),(0,t.jsx)("option",{value:"Media",children:"Media - Necesita atencion pronto"}),(0,t.jsx)("option",{value:"Alta",children:"Alta - Urgente"})]}),(0,t.jsx)("p",{id:"prioridad-hint",className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Indique la urgencia del problema"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"descripcion",className:"label",children:["Descripcion detallada ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("textarea",{id:"descripcion",name:"descripcion",required:!0,value:y,onChange:e=>N(e.target.value),className:"input min-h-[150px] resize-y",placeholder:"Describa el problema con el mayor detalle posible. Incluya pasos para reproducirlo, mensajes de error, etc.","aria-describedby":"descripcion-hint"}),(0,t.jsx)("p",{id:"descripcion-hint",className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Proporcione todos los detalles que puedan ayudar a resolver el problema"})]}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 pt-4",children:[(0,t.jsx)("button",{type:"submit",disabled:r,className:"btn-primary flex-1 py-3",children:r?(0,t.jsxs)("span",{className:"flex items-center justify-center",children:[(0,t.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","aria-hidden":"true",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Creando ticket..."]}):"Crear Ticket"}),(0,t.jsx)("button",{type:"button",onClick:()=>e.back(),className:"btn-secondary flex-1 py-3",children:"Cancelar"})]})]})]})})}}},function(e){e.O(0,[7648,7859,3464,6137,1076,2971,2117,1744],function(){return e(e.s=44022)}),_N_E=e.O()}]);