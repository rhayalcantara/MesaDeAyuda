(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7742],{61380:function(e,a,t){Promise.resolve().then(t.bind(t,522))},522:function(e,a,t){"use strict";t.d(a,{default:function(){return u}});var i=t(57437),r=t(2265),d=t(99376),s=t(27648),o=t(11888),l=t(71837);let c=[{id:1,nombre:"Sistema de Ventas",activa:!0},{id:2,nombre:"Sistema de Inventario",activa:!0},{id:3,nombre:"Portal Web",activa:!0},{id:4,nombre:"Aplicacion Movil",activa:!0},{id:5,nombre:"Otro",activa:!0}],n=[{id:1,nombre:"Admin Demo"},{id:2,nombre:"Empleado Demo"}],m={id:1,titulo:"Error al cargar reportes en el sistema",descripcion:"Al intentar generar el reporte mensual de ventas, el sistema muestra un error de timeout. El problema ocurre cuando se seleccionan fechas mayores a 30 dias.",estado:"EnProceso",prioridad:"Alta",categoriaId:1,empleadoAsignadoId:2};function u(){let e=(0,d.useParams)(),a=(0,d.useRouter)(),t=e.id,[u,p]=(0,r.useState)(!0),[x,g]=(0,r.useState)(!1),[h,b]=(0,r.useState)([]),[j,v]=(0,r.useState)([]),[f,y]=(0,r.useState)({titulo:"",descripcion:"",estado:"Abierto",prioridad:"Media",categoriaId:"",empleadoAsignadoId:""}),[I,N]=(0,r.useState)({});(0,r.useEffect)(()=>{k()},[t]);let k=async()=>{try{let e=(await l.ZP.get("/tickets/".concat(t))).data;y({titulo:e.titulo,descripcion:e.descripcion,estado:e.estado,prioridad:e.prioridad,categoriaId:String(e.categoriaId),empleadoAsignadoId:e.empleadoAsignadoId?String(e.empleadoAsignadoId):""});try{let e=await l.ZP.get("/categorias");b(e.data)}catch(e){b(c)}try{let e=await l.ZP.get("/usuarios/empleados");v(e.data)}catch(e){v(n)}}catch(a){console.log("Using demo data (API not available)");let e={...m,id:parseInt(t)};y({titulo:e.titulo,descripcion:e.descripcion,estado:e.estado,prioridad:e.prioridad,categoriaId:String(e.categoriaId),empleadoAsignadoId:e.empleadoAsignadoId?String(e.empleadoAsignadoId):""}),b(c),v(n)}finally{p(!1)}},A=()=>{let e={};return f.titulo.trim()?f.titulo.length>200&&(e.titulo="El titulo no puede exceder 200 caracteres"):e.titulo="El titulo es requerido",f.descripcion.trim()||(e.descripcion="La descripcion es requerida"),f.categoriaId||(e.categoriaId="Seleccione una categoria"),N(e),0===Object.keys(e).length},E=async e=>{if(e.preventDefault(),A()){g(!0);try{await l.ZP.put("/tickets/".concat(t),{...f,categoriaId:parseInt(f.categoriaId),empleadoAsignadoId:f.empleadoAsignadoId?parseInt(f.empleadoAsignadoId):null}),a.push("/admin/tickets/".concat(t))}catch(e){console.log("Demo: Ticket would be updated"),a.push("/admin/tickets/".concat(t))}}},w=e=>{let{name:a,value:t}=e.target;y(e=>({...e,[a]:t})),I[a]&&N(e=>({...e,[a]:""}))};return u?(0,i.jsx)(o.Zn,{requiredRoles:["Admin"],children:(0,i.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,i.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})})}):(0,i.jsx)(o.Zn,{requiredRoles:["Admin"],children:(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400 mb-2",children:[(0,i.jsx)(s.default,{href:"/admin/tickets",className:"hover:text-primary-600",children:"Tickets"}),(0,i.jsx)("span",{children:"/"}),(0,i.jsxs)(s.default,{href:"/admin/tickets/".concat(t),className:"hover:text-primary-600",children:["#",t]}),(0,i.jsx)("span",{children:"/"}),(0,i.jsx)("span",{children:"Editar"})]}),(0,i.jsxs)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["Editar Ticket #",t]})]}),(0,i.jsxs)("form",{onSubmit:E,className:"card p-6 space-y-6",children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("label",{htmlFor:"titulo",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Titulo del ticket ",(0,i.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,i.jsx)("input",{type:"text",id:"titulo",name:"titulo",value:f.titulo,onChange:w,className:"input w-full ".concat(I.titulo?"border-red-500":""),placeholder:"Describe brevemente el problema","aria-invalid":!!I.titulo,"aria-describedby":I.titulo?"titulo-error":void 0}),I.titulo&&(0,i.jsx)("p",{id:"titulo-error",className:"mt-1 text-sm text-red-500",role:"alert",children:I.titulo})]}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("label",{htmlFor:"estado",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Estado ",(0,i.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,i.jsxs)("select",{id:"estado",name:"estado",value:f.estado,onChange:w,className:"input w-full",children:[(0,i.jsx)("option",{value:"Abierto",children:"Abierto"}),(0,i.jsx)("option",{value:"EnProceso",children:"En Proceso"}),(0,i.jsx)("option",{value:"EnEspera",children:"En Espera"}),(0,i.jsx)("option",{value:"Resuelto",children:"Resuelto"}),(0,i.jsx)("option",{value:"Cerrado",children:"Cerrado"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("label",{htmlFor:"prioridad",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Prioridad ",(0,i.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,i.jsxs)("select",{id:"prioridad",name:"prioridad",value:f.prioridad,onChange:w,className:"input w-full",children:[(0,i.jsx)("option",{value:"Baja",children:"Baja"}),(0,i.jsx)("option",{value:"Media",children:"Media"}),(0,i.jsx)("option",{value:"Alta",children:"Alta"})]})]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("label",{htmlFor:"categoriaId",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Categoria ",(0,i.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,i.jsxs)("select",{id:"categoriaId",name:"categoriaId",value:f.categoriaId,onChange:w,className:"input w-full ".concat(I.categoriaId?"border-red-500":""),"aria-invalid":!!I.categoriaId,"aria-describedby":I.categoriaId?"categoria-error":void 0,children:[(0,i.jsx)("option",{value:"",children:"Seleccione una categoria"}),h.filter(e=>e.activa).map(e=>(0,i.jsx)("option",{value:e.id,children:e.nombre},e.id))]}),I.categoriaId&&(0,i.jsx)("p",{id:"categoria-error",className:"mt-1 text-sm text-red-500",role:"alert",children:I.categoriaId})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"empleadoAsignadoId",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Asignar a empleado"}),(0,i.jsxs)("select",{id:"empleadoAsignadoId",name:"empleadoAsignadoId",value:f.empleadoAsignadoId,onChange:w,className:"input w-full",children:[(0,i.jsx)("option",{value:"",children:"Sin asignar"}),j.map(e=>(0,i.jsx)("option",{value:e.id,children:e.nombre},e.id))]})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("label",{htmlFor:"descripcion",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Descripcion detallada ",(0,i.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,i.jsx)("textarea",{id:"descripcion",name:"descripcion",value:f.descripcion,onChange:w,rows:6,className:"input w-full ".concat(I.descripcion?"border-red-500":""),placeholder:"Describa el problema con el mayor detalle posible","aria-invalid":!!I.descripcion,"aria-describedby":I.descripcion?"descripcion-error":void 0}),I.descripcion&&(0,i.jsx)("p",{id:"descripcion-error",className:"mt-1 text-sm text-red-500",role:"alert",children:I.descripcion})]}),(0,i.jsxs)("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200 dark:border-gray-700",children:[(0,i.jsx)(s.default,{href:"/admin/tickets/".concat(t),className:"btn-secondary",children:"Cancelar"}),(0,i.jsx)("button",{type:"submit",disabled:x,className:"btn-primary",children:x?"Guardando...":"Guardar cambios"})]})]})]})})}},11888:function(e,a,t){"use strict";t.d(a,{Zn:function(){return i.Z}}),t(42530),t(57018);var i=t(81076)}},function(e){e.O(0,[7648,7859,3464,6137,1076,2971,2117,1744],function(){return e(e.s=61380)}),_N_E=e.O()}]);